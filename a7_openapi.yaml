openapi: 3.0.0

info:
 version: '1.0'
 title: 'LBAW ASKIT Web API'
 description: 'Web Resources Specification (A7) for ASKIT'

tags:
- name: 'M01: Authentication'
- name: 'M02: Individual Profile and User administration'
- name: 'M03: Publications' 
- name: 'M04: Static pages'
- name: 'M05: Reports'
- name: 'M06: Notifications'


paths:
# MODULE 01: Authentication
  /login:
    get:
      operationId: R101
      summary: 'R101: Login Form'
      description: 'Provide login form. Access: PUB'
      tags: 
        - 'M01: Authentication'
      responses: 
        '200':
          description: 'Ok. Show Log-in Page'
        
    post:
      operationId: R102
      summary : 'R102: Login Action'
      description:  'Processes the login form submission. Access: PUB'
      tags:
        - 'M01: Authentication'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: 'The email of the user'
                password:
                  type: string
                  description: 'The password of the user'
              required:
                - email
                - password
                
      responses: 
        '302':  
          description: 'Redirect after login'
          headers:
            Location:
              description: 'URL for redirection'
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful authentication. Redirect to user profile.'
                  value: '/'
                302Error:
                  description: 'Failed authentication. Redirect to Login Page.'
                  value: '/auth/login'

  /logout:
    post:
      operationId: R103
      summary: 'R103: Logout Action'
      description: 'Processes the logout action. Access: USR'
      tags:
        - 'M01: Authentication'
      responses:
        '302':
          description: 'Redirect to Home Page'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful logout. Redirect to login page.'
                  value: '/'
                302Error:
                  description: 'Failed logout. Redirect to Home Page'
                  value: '/' 

  /register:
    get:
      operationId: R104
      summary: 'R104: Register Form'
      description: 'Provide register form. Access: PUB'
      tags:
        - 'M01: Authentication'
      responses:
        '200':
          description: 'Ok. Show Register Page'
    
    post:
      operationId: R105
      summary: 'R105: Register Action'
      description: 'Processes the register form submission. Access: PUB'
      tags:
        - 'M01: Authentication'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: 'The name of the user'
                username:
                  type: string
                  description: 'The username of the user'
                email:
                  type: string
                  description: 'The email of the user'
                password:
                  type: string
                  description: 'The password of the user'
                password_confirmation:
                  type: string
                  description: 'The password confirmation of the user'
                image:
                  type: string
                  format: binary
                  description: 'The image of the user'
              required:
                - name
                - email
                - password
                - password_confirmation
      responses:
        '302':
          description: 'Redirect after registration'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful registration. Redirect to user profile.'
                  value: '/'
                302Error:
                  description: 'Failed registration. Redirect to Register Page'
                  value: '/auth/register'

  /recoverpassword:
    get:
      operationId: R106
      summary: 'R106: Recover Password Form'
      description: 'Provide recover password form. Access: PUB'
      tags:
        - 'M01: Authentication'
      responses:
        '200':
          description: 'Ok. Show Recover Password Page'
    
    post:
      operationId: R107
      summary: 'R107: Recover Password Action'
      description: 'Processes the recover password form submission. Access: PUB'
      tags:
        - 'M01: Authentication'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: 'The email of the user'
              required:
                - email
      responses:
        '302':
          description: 'Redirect after password recovery'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful password recovery. Redirect to login page.'
                  value: '/auth/login'
                302Error:
                  description: 'Failed password recovery. Redirect to Recover Password Page'
                  value: '/auth/recoverpassword'
  /login/google:
    get:
      operationId: R108
      summary: 'R108: Google Login'
      description: 'Initiates login with Google. Access: PUB'
      tags:
        - 'M01: Authentication'
      responses:
        '302':
          description: 'Redirect to Google for authentication'
          headers:
            Location:
              description: 'Google OAuth2 authorization URL'
              schema:
                type: string

  /login/github:
    get:
      operationId: R109
      summary: 'R109: GitHub Login'
      description: 'Initiates login with GitHub. Access: PUB'
      tags:
        - 'M01: Authentication'
      responses:
        '302':
          description: 'Redirect to GitHub for authentication'
          headers:
            Location:
              description: 'GitHub OAuth2 authorization URL'
              schema:
                type: string

  /login/callback:
    get:
      operationId: R110
      summary: 'R110: OAuth Callback'
      description: 'Handles the callback after authentication with an external provider. Access: PUB'
      tags:
        - 'M01: Authentication'
      parameters:
        - name: provider
          in: query
          description: 'The authentication provider (e.g., google, github)'
          required: true
          schema:
            type: string
      responses:
        '302':
          description: 'Redirect after successful or failed external login'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful authentication. Redirect to user profile.'
                  value: '/'
                302Error:
                  description: 'Failed authentication. Redirect to Login Page.'
                  value: '/auth/login'

# MODULE 02: Individual Profile and User administration

  /profile/{username}:
    get:
      operationId: R201
      summary: 'R201: View Profile'
      description: 'Provide user profile page. Access: PUB'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: username
          description: 'The username of the user'
          schema:
            type: string
          required: true
      responses:
        '200':
          description: 'Ok. Show User Profile Page'
        '404':
          description: 'User not found'
    
    delete:
      operationId: R202
      summary: 'R202: Delete User'
      description: 'Delete user. Access: ADM & OWN'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: username
          description: 'The username of the user'
          schema:
            type: string
          required: true
      responses:
        '202':
          description: 'Accepted. User deleted'
        '404':
          description: 'User not found'
  
  /profile/edit:
    get:
      operationId: R203
      summary: 'R203: Edit Profile'
      description: 'Provide user profile edit form. Access: OWN, ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      responses:
        '200':
          description: 'Ok. Show User Profile Edit Page'
    patch:
      operationId: R204
      summary: 'R204: Update Profile'
      description: 'Processes the user profile edit form submission. Access: OWN, ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: 'The name of the user'
                email:
                  type: string
                  description: 'The email of the user'
                bio:
                  type: string
                  description: 'The bio of the user'
                image:
                  type: string
                  format: binary
                  description: 'The image of the user'
              example:
                name: 'John Doe'
                email: 'john@example.com'
                bio: 'I am a software engineer'
                image: 'marcelorebelodesousa.jpg'
      responses:
        '302':
          description: 'Redirect after profile update'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful profile update. Redirect to user profile.'
                  value: '/profile/{username}'
                302Error:
                  description: 'Failed profile update. Redirect to Edit Profile Page'
  
  /profile/search:
    get:
      operationId: R205
      summary: 'R205: Search User'
      description: 'Provide user search page. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: query
          name: username
          description: 'The username of the user'
          schema:
            type: string
          required: true
      responses:
        '200':
          description: 'Ok. Show User Search Page'

  /profile/ban/{username}:
    patch:
      operationId: R206
      summary: 'R206: Ban User'
      description: 'Ban user. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: username
          description: 'The username of the user'
          schema:
            type: string
          required: true
      responses:
        '202':
          description: 'Accepted. User banned'
        '404':
          description: 'User not found'
  /profile/unban/{username}: 
    patch:
      operationId: R207
      summary: 'R207: Unban User'
      description: 'Unban user. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: username
          description: 'The username of the user'
          schema:
            type: string
          required: true
      responses:
        '202':
          description: 'Accepted. User unbanned'
        '404':
          description: 'User not found'

  /admin/managetags:
    get:
      operationId: R206
      summary: 'R206: Manage Tags'
      description: 'Provide manage tags page. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      responses:
        '200':
          description: 'Ok. Show Manage Tags Page'
    post:
      operationId: R207
      summary: 'R207: Create Tag'
      description: 'Processes the create tag form submission. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: 'The name of the tag'
              required:
                - name
              example:
                name: 'Web API'
      responses:
        '302':
          description: 'Redirect after tag creation'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful tag creation. Redirect to Manage Tags Page.'
                  value: '/admin/managetags'
                302Error:
                  description: 'Failed tag creation. Redirect to Manage Tags Page'
                  value: '/admin/managetags'
  /admin/managetags/{name}:  
    delete:
      operationId: R208
      summary: 'R208: Delete Tag'
      description: 'Delete tag. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: name
          description: 'The name of the tag'
          schema:
            type: string
          required: true
      responses:
        '202':
          description: 'Accepted. Tag deleted'
        '404':
          description: 'Tag not found'
  /admin/managereports/{id}:
    get:
      operationId: R209
      summary: 'R209: Manage Reports'
      description: 'Provide manage reports page. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: id
          description: 'The id of the report'
          schema:
            type: integer
          required: true
      responses:
        '200':
          description: 'Ok. Show Manage Reports Page'
    put:
      operationId: R210
      summary: 'R210: Resolve report'
      description: 'Resolve report. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: id
          description: 'The id of the report'
          schema:
            type: integer
          required: true
      responses:
        '200':
          description: 'Report resolved successfully'
        '400':
          description: 'Invalid report id'
        '404':
          description: 'Report not found'
    
  /profile/{username}/ban:
    patch:
      operationId: R206
      summary: 'R206: Ban User'
      description: 'Ban user. Access: ADM'
      tags:
        - 'M02: Individual Profile and User administration'
      parameters:
        - in: path
          name: username
          description: 'The username of the user'
          schema:
            type: string
          required: true
      responses:
        '202':
          description: 'Accepted. User banned'
        '404':
          description: 'User not found'

# MODULE 03: Publications

  /questions/create:
    get:
      operationId: R301
      summary: 'R301: Create Question Form'
      description: 'Provide create question form. Access: USR'
      tags:
        - 'M03: Publications'
      responses:
        '200':
          description: 'Ok. Show Create Question Page'
  /questions:
    post:
      operationId: R302
      summary: 'R302: Create Question Action'
      description: 'Processes the create question form submission. Access: USR'
      tags:
        - 'M03: Publications'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                title:
                  type: string
                  description: 'The title of the question'
                content:
                  type: string
                  description: 'The body of the question'
                tags:
                  type: string
                  description: 'The tags of the question'
              required:
                - title
                - content
              example:
                title: 'How to create a web API?'
                content: 'I am trying to create a web API but I am having some trouble. Can someone help me?'
      responses:
        '302':
          description: 'Redirect after question creation'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful question creation. Redirect to question page.'
                  value: '/'
                302Error:
                  description: 'Failed question creation. Redirect to Create Question Page'
                  value: '/questions/create'
  /questions/{id}/vote:
    post:
      operationId: R303
      summary: 'R303: Vote Question'
      description: 'Vote question. Access: USR'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the question'
          schema:
            type: integer
          required: true
      responses:
        '202':
          description: 'Accepted. Question voted'
        '404':
          description: 'Question not found'
      
  /questions/search:
    get:
      operationId: R304
      summary: 'R304: Search Questions'
      description: 'Provide search questions page. Access: PUB'
      tags:
        - 'M03: Publications'
      parameters:
        - in: query
          name: query
          description: 'Search query'
          schema:
            type: string
          required: true
      responses:
        '200':
          description: 'Ok. Show Search Questions Page'
  /questions/{id}:
    get:
      operationId: R305
      summary: 'R305: View Question'
      description: 'Provide question page. Access: PUB'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the question'
          schema:
            type: integer
          required: true
      responses:
        '200':
          description: 'Ok. Show Question Page'
        '404':
          description: 'Question not found'
    delete:
      operationId: R306
      summary: 'R306: Delete Question'
      description: 'Delete question. Access: OWN & ADM'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the question'
          schema:
            type: integer
          required: true
      responses:
        '302':
          description: 'Redirect after question deletion'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful question deletion. Redirect to Home Page.'
                  value: '/'
                302Error:
                  description: 'Failed question deletion. Redirect to Question Page'
                  value: '/questions/{id}'
    put:
      operationId: R307
      summary: 'R307: Update Question'
      description: 'Processes the question edit form submission. Access: OWN & ADM'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the question'
          schema:
            type: integer
          required: true
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                title:
                  type: string
                  description: 'The title of the question'
                content:
                  type: string
                  description: 'The body of the question'
              required:
                - title
                - content
              example:
                title: 'How to create a web API?'
                content: 'I am trying to create a web API but I am having a trouble with sql. Can someone help me?'
      responses:
        '302':
          description: 'Redirect after question update'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful question update. Redirect to question page.'
                  value: '/questions/{id}'
                302Error:
                  description: 'Failed question update. Redirect to Edit Question Page'
                  value: '/questions/{id}/edit'

  /questions/{id}/edit:
    get:
      operationId: R308
      summary: 'R308: Edit Question'
      description: 'Provide question edit form. Access: OWN & ADM'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the question'
          schema:
            type: integer
          required: true
      responses:
        '200':
          description: 'Ok. Show Edit Question Page'

  /questions/{id}/answer/create:
    get:
      operationId: R309
      summary: 'R309: Create Answer Form'
      description: 'Provide create answer form. Access: USR'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the question'
          schema:
            type: integer
          required: true
      responses:
        '200':
          description: 'Ok. Show Create Answer Page'
  /answers:
    post:
      operationId: R310
      summary: 'R310: Create Answer Action'
      description: 'Processes the create answer form submission. Access: USR'
      tags:
        - 'M03: Publications'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                content:
                  type: string
                  description: 'The body of the answer'
              required:
                - content
              example:
                content: 'You can create a web API by following these steps...'
      responses:
        '302':
          description: 'Redirect after answer creation'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful answer creation. Redirect to question page.'
                  value: '/questions/{id}'
                302Error:
                  description: 'Failed answer creation. Redirect to Create Answer Page'
                  value: '/questions/{id}/answer/create'
  /answers/{id}/vote:
    post:
      operationId: R311
      summary: 'R311: Vote Answer'
      description: 'Vote answer. Access: USR'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the answer'
          schema:
            type: integer
          required: true
      responses:
        '202':
          description: 'Accepted. Answer voted'
        '404':
          description: 'Answer not found'
    
  /answers/{id}:
    put:
      operationId: R312
      summary: 'R312: Update Answer'
      description: 'Processes the answer edit form submission. Access: OWN & ADM'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the answer'
          schema:
            type: integer
          required: true
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                content:
                  type: string
                  description: 'The body of the answer'
              required:
                - content
              example:
                content: 'You can create a web API by following these steps...'
      responses:
        '302':
          description: 'Redirect after answer update'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful answer update. Redirect to question page.'
                  value: '/questions/{id}'
                302Error:
                  description: 'Failed answer update. Redirect to Edit Answer Page'
                  value: '/answers/{id}/edit'
    delete:
      operationId: R313
      summary: 'R313: Delete Answer'
      description: 'Delete answer. Access: OWN & ADM'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the answer'
          schema:
            type: integer
          required: true
      responses:
        '302':
          description: 'Redirect after answer deletion'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful answer deletion. Redirect to question page.'
                  value: '/questions/{id}'
                302Error:
                  description: 'Failed answer deletion. Redirect to question page'
                  value: '/questions/{id}'

  /answers/{id}/edit:
    get:
      operationId: R314
      summary: 'R314: Edit Answer'
      description: 'Provide answer edit form. Access: OWN & ADM'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the answer'
          schema:
            type: integer
          required: true
      responses:
        '200':
          description: 'Ok. Show Edit Answer Page'
  /answers/{id}/accept:
    patch:
      operationId: R315
      summary: 'R315: Accept Answer'
      description: 'Accept answer. Access: OWN'
      tags:
        - 'M03: Publications'
      parameters:
        - in: path
          name: id
          description: 'The id of the answer'
          schema:
            type: integer
          required: true
      responses:
        '202':
          description: 'Accepted. Answer accepted'
        '404':
          description: 'Answer not found'

# MODULE 04: Static pages
  /:
    get:
      operationId: R401
      summary: 'R401: Home Page'
      description: 'Provide home page. Access: PUB'
      tags:
        - 'M04: Static pages'
      responses:
        '202':
          description: 'Ok. Show Home Page'
  /aboutus:
    get:
      operationId: R402
      summary: 'R402: About Us Page'
      description: 'Provide about us page. Access: PUB'
      tags:
        - 'M04: Static pages'
      responses:
        '202':
          description: 'Ok. Show About Us Page'

  /mainfeatures:
    get:
      operationId: R403
      summary: 'R403: Main Features Page'
      description: 'Provide main features page. Access: PUB'
      tags:
        - 'M04: Static pages'
      responses:
        '202':
          description: 'Ok. Show Main Features Page'

# MODULE 05: Reports
  /report:
    get:
      operationId: R500
      summary: 'R500: Report Form'
      description: 'Provide report form. Access: USR'
      tags:
        - 'M05: Reports'
      responses:
        '200':
          description: 'Ok. Show Report Page'
    post:
      operationId: R501
      summary: 'R501: Report Action'
      description: 'Processes the report form submission. Access: USR'
      tags:
        - 'M05: Reports'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                content:
                  type: string
                  description: 'The content of the report'
              required:
                - content
              example:
                content: 'This user is posting inappropriate content'
      responses:
        '302':
          description: 'Redirect after report submission'
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: 'Successful report submission. Redirect to Home Page.'
                  value: '/'
                302Error:
                  description: 'Failed report submission. Redirect to Home Page'
                  value: '/'

# MODULE 06: Notifications
  /notifications:
    get:
      operationId: R600
      summary: 'R600: Notifications Page'
      description: 'Provide notifications page. Access: OWN'
      tags:
        - 'M06: Notifications'
      responses:
        '200':
          description: 'Ok. Show Notifications Page'
    post:
      operationId: R601
      summary: 'R601: Mark as Read'
      description: 'Mark notification as read. Access: OWN'
      tags:
        - 'M06: Notifications'
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                id:
                  type: integer
                  description: 'The id of the notification'
              required:
                - id
              example:
                id: 1
      responses:
        '202':
          description: 'Accepted. Notification marked as read'
        '404':
          description: 'Notification not found'